# 🚀 دليل تركيب وتشغيل نظام Top Marketing

## 📋 نظرة عامة
نظام إدارة التسويق المتكامل - منصة شاملة لإدارة خدمات التصميم والتسويق والمونتاج وصفحات السوشيال ميديا مع نظام إدارة العقارات.

## 🔧 المتطلبات الأساسية

### البرامج المطلوبة:
- **Node.js** (الإصدار 18 أو أحدث) - [تحميل من هنا](https://nodejs.org/)
- **NPM** (يأتي مع Node.js)
- **Git** (اختياري) - [تحميل من هنا](https://git-scm.com/)

### قاعدة البيانات:
- **Supabase** (مجاني) - [إنشاء حساب](https://supabase.com/)

## 📦 خطوات التركيب

### 1. تحضير المشروع
```bash
# تحميل أو نسخ مجلد المشروع
cd admintop

# تثبيت المكتبات المطلوبة
npm install
```

### 2. إعداد قاعدة البيانات (Supabase)

#### أ. إنشاء مشروع جديد:
1. اذهب إلى [Supabase](https://supabase.com/)
2. أنشئ حساب جديد أو سجل دخول
3. اضغط "New Project"
4. اختر اسم المشروع وكلمة مرور قوية
5. انتظر حتى يتم إنشاء المشروع (2-3 دقائق)

#### ب. تطبيق هيكل قاعدة البيانات:
1. اذهب إلى "SQL Editor" في لوحة تحكم Supabase
2. انسخ محتوى ملف `database/schema.sql`
3. الصق المحتوى في المحرر واضغط "Run"

#### ج. الحصول على مفاتيح الاتصال:
1. اذهب إلى "Settings" → "API"
2. انسخ:
   - **Project URL** (URL المشروع)
   - **anon public** (المفتاح العام)

### 3. إعداد متغيرات البيئة

#### أ. إنشاء ملف `.env.local`:
```bash
# انسخ ملف المثال
cp .env.example .env.local
```

#### ب. تحرير ملف `.env.local`:
```env
# Supabase Configuration
NEXT_PUBLIC_SUPABASE_URL=https://your-project-id.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key-here

# Environment
NODE_ENV=development
```

**⚠️ مهم:** استبدل القيم بالمفاتيح الحقيقية من مشروع Supabase الخاص بك.

## 🚀 تشغيل المشروع

### للتطوير المحلي:
```bash
npm run dev
```
سيعمل الموقع على: `http://localhost:3000`

### للإنتاج:
```bash
# بناء المشروع
npm run build

# تشغيل الإنتاج
npm start
```

## 📁 هيكل المشروع

### المجلدات الرئيسية:

#### `src/app/` - صفحات وواجهات Next.js
- `(public)/` - الصفحات العامة للزوار
- `admin/` - لوحة تحكم الإدارة
- `api/` - واجهات برمجة التطبيقات الداخلية

#### `src/components/` - مكونات واجهة المستخدم
- `admin/` - مكونات خاصة بلوحة الإدارة
- `ui/` - مكونات واجهة المستخدم العامة

#### `src/lib/` - المكتبات والأدوات
- `supabase.ts` - إعداد اتصال قاعدة البيانات
- `auth.ts` - وظائف المصادقة

#### `database/` - ملفات قاعدة البيانات
- `schema.sql` - هيكل قاعدة البيانات الكامل

#### `public/` - الملفات العامة
- الصور والأيقونات والملفات الثابتة

## 🔐 نظام المصادقة والأدوار

### أنواع المستخدمين:

#### 1. **الزوار** (Visitors)
- **العربية:** زائر
- **الإنجليزية:** Visitor
- **الصلاحيات:** تصفح الخدمات، طلب الخدمات، إضافة عقارات

#### 2. **الإدارة** (Admins)
- **العربية:** مدير
- **الإنجليزية:** Admin
- **الأدوار:**
  - `super_admin` - مدير عام (صلاحيات كاملة)
  - `marketing_manager` - مدير تسويق (الخدمات والباقات)
  - `real_estate_manager` - مدير عقارات (العقارات فقط)
  - `packages_manager` - مدير باقات (الباقات فقط)
  - `support` - دعم فني (كل شيء عدا إدارة المدراء)

## 📊 الوحدات الرئيسية

### 1. **إدارة الخدمات** (Services Management)
- **العربية:** إدارة الخدمات
- **الإنجليزية:** Services Management
- **الوظائف:** إضافة/تعديل الخدمات الأساسية والفرعية

### 2. **إدارة الباقات** (Packages Management)
- **العربية:** إدارة الباقات
- **الإنجليزية:** Packages Management
- **الوظائف:** إنشاء باقات التسويق والاشتراكات

### 3. **نظام العقارات** (Real Estate System)
- **العربية:** نظام العقارات
- **الإنجليزية:** Real Estate System
- **الوظائف:** إدارة العقارات، المطابقة، المتابعة

### 4. **الإحصائيات** (Analytics)
- **العربية:** الإحصائيات
- **الإنجليزية:** Analytics
- **الوظائف:** تقارير المبيعات والأداء

### 5. **المطابقة** (Matching)
- **العربية:** المطابقة
- **الإنجليزية:** Matching
- **الوظائف:** مطابقة العقارات بين البائعين والمشترين

## 🌐 النشر على الاستضافة

### Vercel (مجاني):
1. اذهب إلى [Vercel](https://vercel.com/)
2. ربط حساب GitHub
3. استيراد المشروع
4. إضافة متغيرات البيئة في إعدادات Vercel
5. النشر التلقائي

### Netlify (مجاني):
1. اذهب إلى [Netlify](https://netlify.com/)
2. ربط حساب GitHub
3. استيراد المشروع
4. إضافة متغيرات البيئة
5. النشر

## 🔧 إعدادات إضافية

### تفعيل تخزين الملفات (Supabase Storage):
1. اذهب إلى "Storage" في Supabase
2. أنشئ buckets جديدة:
   - `receipts` - للإيصالات
   - `portfolio` - لمعرض الأعمال
   - `properties` - لصور العقارات

### إنشاء مدير أول:
```sql
-- تشغيل في SQL Editor في Supabase
INSERT INTO admins (username, email, name, password_hash, role) 
VALUES ('admin', 'admin@topmarketing.com', 'المدير العام', '$2a$10$hashed_password', 'super_admin');
```

## 🆘 استكشاف الأخطاء

### مشاكل شائعة:

#### 1. خطأ في الاتصال بقاعدة البيانات:
- تأكد من صحة متغيرات البيئة
- تحقق من أن مشروع Supabase يعمل

#### 2. خطأ في تثبيت المكتبات:
```bash
# مسح cache وإعادة التثبيت
rm -rf node_modules package-lock.json
npm install
```

#### 3. خطأ في البناء:
```bash
# تشغيل فحص TypeScript
npm run type-check
```

## 📞 الدعم الفني

للحصول على المساعدة:
1. راجع ملف `TROUBLESHOOTING.md`
2. تحقق من logs في المتصفح (F12)
3. راجع logs Supabase في لوحة التحكم

## 📝 ملاحظات مهمة

- **الأمان:** لا تشارك ملف `.env.local` أبداً
- **النسخ الاحتياطي:** احتفظ بنسخة احتياطية من قاعدة البيانات
- **التحديثات:** راجع التحديثات بانتظام
- **الأداء:** استخدم CDN للصور في الإنتاج

---

## 🎯 بدء سريع (Quick Start)

```bash
# 1. تثبيت المكتبات
npm install

# 2. إعداد متغيرات البيئة
cp .env.example .env.local
# عدّل .env.local بمفاتيح Supabase

# 3. تشغيل المشروع
npm run dev

# 4. افتح المتصفح على
# http://localhost:3000
```

**🎉 مبروك! موقعك جاهز للعمل**
